---
title: "First task"
author: "Akvilė Višniauskaitė ir Ieva Pudžiuvelytė"
date: "3/11/2022"
output: pdf_document
bibliography: references.bib
csl: apa-single-spaced.csl
---

# Introduction

This work will present data analysis from a research that studied the 
enchancer's at *IGF2* differential methylation association with abnormal 
dopamine synthesis in major psychosis [@pai2019differential].

Our samples were taken from the prefrontal cortex isolated neurons in 
schizophrenia and bipolar disorder.

Study analysed data from individuals diagnosed with schizophrenia, bipolar
disorder and controls (29, 26 and 27 individuals, respectively).
In the analysis study controlled for age, sex, post-mortem interval, genetic 
ancestry (determined by genotyping the same individuals).

## Experiment design

The experiment design was multi-omics study with 55 cases (with schizophrenia or
bipolar disorder) and 27 controls.

## Objective of the research

According to authors, schizophrenia and bipolar disorder have got characteristic 
of periods of psychosis. The main objective of the research was to gather 
epigenomic profiling data to get a more accurate model of neuronal 
dysregulation in diseases with periods of psychosis.

## Biological targets of the research

Researchers intended to look for specific patters of DNA methylation in 
isolated neurons from the frontal cortex of individuals that had diseases.

- IGF2 - insulin growth factor 2 protein
- *IGF2* - IGF2 gene
- *Igf2* - enhancer of *IGF2*
- TH - tyrosine hydroxylase protein
- dopamine - a neuromodulatory molecule
- psychosis - an abnormal condition of the mind that results in difficulties 
  determining what is real and what is not real 

## Results received

Authors found a strong association between methylation of *Igf2* and TH 
synthesis. 
TH is the bottleneck enzyme that is responsible for dopamine synthesis. 
If enhancer *Igf2* is hypomethylated, levels of TH are higher, which 
determines the higher production
of dopamine. Apparently, dopamine is responsible for psychosis in the 
mental disorders of interest.

## Additional information

Schizophrenia and bipolar disorder patients are consistently hypomethylated
at *IGF2* locus when compared to controls. This locus remained significantly 
hypomethylated even after accounting lifestyle-related variables of smoking
and anti-psychotic use.

The reaction chain of interest of the research (upward arrows show elevated
expression or synthesis of the protein, product, or effect):

Hypomethylation of *Igf2* $\rightarrow$ $\uparrow$ IGF2 $\rightarrow$ 
$\uparrow$ TH $\rightarrow$ $\uparrow$ dopamine $\rightarrow$ $\uparrow$ 
psychosis

# Data preparation

```{r}
#BiocManager::install("minfi")
#BiocManager::install("IlluminaHumanMethylationEPICmanifest")
library(minfi)
library(IlluminaHumanMethylationEPICmanifest)
```

```{r include=FALSE}
sample_keys <- read.csv('../data/GSE112179_RAW/GSE112179.csv')

# Basename
sample_keys$Basename <- paste('../data/GSE112179_RAW/', sample_keys$Basename, sep='')
(sample_keys$Basename)

# Unknown values
sample_keys$pmi[sample_keys$pmi == "unknown"] <- NA_real_
sample_keys$pmi[sample_keys$pmi == "?"] <- NA_real_
sample_keys$race[sample_keys$race == "?"] <- NA_character_

# Lower case
sample_keys$race <- tolower(sample_keys$race)
sample_keys$sex <- tolower(sample_keys$sex)
sample_keys$diagnosis <- tolower(sample_keys$diagnosis)
```

Sample keys heading is made of the following columns names:

- *id* - an identifier of the sample
- *sentrix_id* - Illumina's Sentrix BeadChip identifier 
  (`r length(unique(sample_keys$sentrix_id))` unique values) 
  [@imatsentrix]
- *sentrix_row* - row number in the Sentrix array
- *sentrix_col* - column number in the Sentrix array
- *basename* - sample identifier in the research (joined values in a format:
  \newline [\textit{id}]_[*sentrix_id*]_R0[*sentrix_row*]C0[*sentrix_id*])
- *tissue_bank_id* - an identifying number of the tissue bank from which the 
  sample was taken
- *tissue_bank* - the literal identifier of the tissue bank
- *tissue* - a tissue type from which the sample was taken
- *cell_type* - a cell type found in the sample
- *donor* - an integer number that identifies the donor of the sample 
  (`r length(unique(sample_keys$donor))` unique values)
- *pmi* - a post-mortem interval (**time units???????????**), unknown values were
  labeled as NA
- *race* - race of the donor (white, black, hispanic, or unknown (NA))
- *sex* - gender of the donor
- *diagnosis* - an experimental group of the donor (bipolar, schizophrenia, or
  control)
- *age* - age of the donor (years)
  
As it was noted in the article, there were 100 records in the sample keys 
dataset.

Reading IDAT data.

```{r include=FALSE}
#rgcs <- read.metharray.exp(targets=sample_keys)
```

Saving RGChannelSet object data to file '../data/GSE112179_RGCS.rgcs'.

```{r include=FALSE}
rgcs_location <- '../data/GSE112179_RGCS.rgcs'
#saveRDS(rgcs, file='../data/GSE112179_RGCS.rgcs')
```

Loading RGChannelSet object to RAM.

```{r include=FALSE}
rgcs_obj <- readRDS(file=rgcs_location)
```

Getting detection p-value for each score of DNA modification. This function 
returns a matrix of scores (one score for each value of modification), which
show, whether the measured intensity can be distinguished from the background.

```{r include=FALSE}
detP <- detectionP(rgcs_obj)
```

```{r}
detP_f <- data.frame(detP)
```

All values that have got p value higher than 0.01 are considered as bad and 
all samples that have more than 1% of bad detection p values will be removed.

Columns determine samples, rows define location of modification.

```{r}
# Calculating how many values compose one percent
one_perc <- round(nrow(detP) / 100)

# Looping over columns (samples)
for(i in 1:ncol(detP_f)) {    
  higher_p <- 0
  # Looping over p values of each sample
  for(p in detP_f[ , i]){
    # p value higher than 0.01 is considered as bad
    if(p > 0.01){
      higher_p <- higher_p+1
    }
  }
  # Getting sample names for removal
  if(higher_p > one_perc){
    print(colnames(detP_f)[i]) 
  }
}
```

None of the samples had more than 1% of bad values, therefore none of the samples
was removed.



# References {-}

